// biome-ignore-all lint: generated file
/* eslint-disable */

var __defProp = Object.defineProperty;
var __name = (target, value) => __defProp(target, "name", { value, configurable: true });

// node_modules/workflow/dist/internal/builtins.js
import { registerStepFunction } from "workflow/internal/private";
async function __builtin_response_array_buffer(res) {
  return res.arrayBuffer();
}
__name(__builtin_response_array_buffer, "__builtin_response_array_buffer");
async function __builtin_response_json(res) {
  return res.json();
}
__name(__builtin_response_json, "__builtin_response_json");
async function __builtin_response_text(res) {
  return res.text();
}
__name(__builtin_response_text, "__builtin_response_text");
registerStepFunction("__builtin_response_array_buffer", __builtin_response_array_buffer);
registerStepFunction("__builtin_response_json", __builtin_response_json);
registerStepFunction("__builtin_response_text", __builtin_response_text);

// lib/workflows/crm-sync.workflow.ts
import { z } from "zod";
var CRMSyncParamsSchema = z.object({
  userId: z.string().uuid("userId must be a valid UUID"),
  provider: z.enum([
    "bloomerang",
    "virtuous",
    "neoncrm",
    "donorperfect"
  ]),
  apiKey: z.string().min(1, "apiKey is required"),
  syncLogId: z.string().uuid("syncLogId must be a valid UUID")
});
async function syncCRMData(params) {
  throw new Error("You attempted to execute workflow syncCRMData function directly. To start a workflow, use start(syncCRMData) from workflow/api");
}
__name(syncCRMData, "syncCRMData");
syncCRMData.workflowId = "workflow//lib/workflows/crm-sync.workflow.ts//syncCRMData";

// lib/workflows/memory-extraction.workflow.ts
import { z as z2 } from "zod";
var MemoryExtractionParamsSchema = z2.object({
  userId: z2.string().uuid("userId must be a valid UUID"),
  chatId: z2.string().uuid("chatId must be a valid UUID"),
  userMessage: z2.string().min(1, "userMessage is required"),
  assistantResponse: z2.string().min(1, "assistantResponse is required"),
  messageId: z2.string().optional(),
  apiKey: z2.string().optional()
});
async function extractMemoriesWorkflow(params) {
  throw new Error("You attempted to execute workflow extractMemoriesWorkflow function directly. To start a workflow, use start(extractMemoriesWorkflow) from workflow/api");
}
__name(extractMemoriesWorkflow, "extractMemoriesWorkflow");
extractMemoriesWorkflow.workflowId = "workflow//lib/workflows/memory-extraction.workflow.ts//extractMemoriesWorkflow";

// virtual-entry.js
import { stepEntrypoint } from "workflow/runtime";
export {
  stepEntrypoint as POST
};
//# sourceMappingURL=data:application/json;base64,ewogICJ2ZXJzaW9uIjogMywKICAic291cmNlcyI6IFsiLi4vLi4vLi4vLi4vLi4vbm9kZV9tb2R1bGVzL3dvcmtmbG93L3NyYy9pbnRlcm5hbC9idWlsdGlucy50cyIsICIuLi8uLi8uLi8uLi8uLi9saWIvd29ya2Zsb3dzL2NybS1zeW5jLndvcmtmbG93LnRzIiwgIi4uLy4uLy4uLy4uLy4uL2xpYi93b3JrZmxvd3MvbWVtb3J5LWV4dHJhY3Rpb24ud29ya2Zsb3cudHMiLCAiLi4vLi4vLi4vLi4vLi4vdmlydHVhbC1lbnRyeS5qcyJdLAogICJzb3VyY2VzQ29udGVudCI6IFtudWxsLCAiLyoqXG4gKiBDUk0gU3luYyBEdXJhYmxlIFdvcmtmbG93XG4gKlxuICogVGhpcyB3b3JrZmxvdyBoYW5kbGVzIENSTSBkYXRhIHN5bmNocm9uaXphdGlvbiB3aXRoOlxuICogLSBBdXRvbWF0aWMgcmV0cnkgb24gdHJhbnNpZW50IGZhaWx1cmVzXG4gKiAtIER1cmFibGUgY2hlY2twb2ludGluZyAocmVzdW1lIGFmdGVyIHNlcnZlciByZXN0YXJ0KVxuICogLSBTdGVwLWxldmVsIG9ic2VydmFiaWxpdHlcbiAqIC0gUmF0ZSBsaW1pdGluZyB3aXRob3V0IHJlc291cmNlIGNvbnN1bXB0aW9uXG4gKlxuICogU3VwcG9ydHM6IEJsb29tZXJhbmcsIFZpcnR1b3VzLCBOZW9uIENSTSwgRG9ub3JQZXJmZWN0XG4gKi8gaW1wb3J0IHsgeiB9IGZyb20gXCJ6b2RcIjtcbi8qKl9faW50ZXJuYWxfd29ya2Zsb3dze1wid29ya2Zsb3dzXCI6e1wibGliL3dvcmtmbG93cy9jcm0tc3luYy53b3JrZmxvdy50c1wiOntcInN5bmNDUk1EYXRhXCI6e1wid29ya2Zsb3dJZFwiOlwid29ya2Zsb3cvL2xpYi93b3JrZmxvd3MvY3JtLXN5bmMud29ya2Zsb3cudHMvL3N5bmNDUk1EYXRhXCJ9fX19Ki87XG4vLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG4vLyBJTlBVVCBWQUxJREFUSU9OIFNDSEVNQVxuLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuLyoqXG4gKiBTdHJpY3Qgc2NoZW1hIGZvciBDUk0gc3luYyBwYXJhbWV0ZXJzXG4gKiBVc2VzIFpvZCBmb3IgcnVudGltZSB2YWxpZGF0aW9uXG4gKi8gZXhwb3J0IGNvbnN0IENSTVN5bmNQYXJhbXNTY2hlbWEgPSB6Lm9iamVjdCh7XG4gICAgdXNlcklkOiB6LnN0cmluZygpLnV1aWQoXCJ1c2VySWQgbXVzdCBiZSBhIHZhbGlkIFVVSURcIiksXG4gICAgcHJvdmlkZXI6IHouZW51bShbXG4gICAgICAgIFwiYmxvb21lcmFuZ1wiLFxuICAgICAgICBcInZpcnR1b3VzXCIsXG4gICAgICAgIFwibmVvbmNybVwiLFxuICAgICAgICBcImRvbm9ycGVyZmVjdFwiXG4gICAgXSksXG4gICAgYXBpS2V5OiB6LnN0cmluZygpLm1pbigxLCBcImFwaUtleSBpcyByZXF1aXJlZFwiKSxcbiAgICBzeW5jTG9nSWQ6IHouc3RyaW5nKCkudXVpZChcInN5bmNMb2dJZCBtdXN0IGJlIGEgdmFsaWQgVVVJRFwiKVxufSk7XG4vLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG4vLyBJTlRFUk5BTCBTVEVQIEZVTkNUSU9OU1xuLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuLyoqXG4gKiBGZXRjaCBhbGwgY29uc3RpdHVlbnRzIGZyb20gQ1JNIHByb3ZpZGVyXG4gKiBUaGlzIGlzIGEgc3RlcCBmdW5jdGlvbiAtIHdpbGwgYmUgY2hlY2twb2ludGVkIGFmdGVyIGNvbXBsZXRpb25cbiAqLyBhc3luYyBmdW5jdGlvbiBmZXRjaENvbnN0aXR1ZW50c1N0ZXAocGFyYW1zKSB7XG4gICAgLy8gRHluYW1pYyBpbXBvcnQgdG8gYXZvaWQgYnVuZGxpbmcgYWxsIENSTSBhZGFwdGVyc1xuICAgIGNvbnN0IHsgZmV0Y2hBbGxCbG9vbWVyYW5nQ29uc3RpdHVlbnRzLCBmZXRjaEFsbFZpcnR1b3VzQ29udGFjdHMsIGZldGNoQWxsTmVvbkNSTUFjY291bnRzLCBmZXRjaEFsbERvbm9yUGVyZmVjdERvbm9ycywgbWFwQmxvb21lcmFuZ0NvbnN0aXR1ZW50LCBtYXBWaXJ0dW91c0NvbnRhY3QsIG1hcE5lb25DUk1BY2NvdW50LCBtYXBEb25vclBlcmZlY3REb25vciwgcGFyc2VOZW9uQ1JNQ3JlZGVudGlhbHMsIENSTV9TWU5DX0NPTkZJRyB9ID0gYXdhaXQgaW1wb3J0KFwiQC9saWIvY3JtXCIpO1xuICAgIGNvbnN0IGNvbnN0aXR1ZW50cyA9IFtdO1xuICAgIGlmIChwYXJhbXMucHJvdmlkZXIgPT09IFwiYmxvb21lcmFuZ1wiKSB7XG4gICAgICAgIGZvciBhd2FpdCAoY29uc3QgYmF0Y2ggb2YgZmV0Y2hBbGxCbG9vbWVyYW5nQ29uc3RpdHVlbnRzKHBhcmFtcy5hcGlLZXksIENSTV9TWU5DX0NPTkZJRy5iYXRjaFNpemUpKXtcbiAgICAgICAgICAgIGZvciAoY29uc3QgYyBvZiBiYXRjaCl7XG4gICAgICAgICAgICAgICAgY29uc3QgbWFwcGVkID0gbWFwQmxvb21lcmFuZ0NvbnN0aXR1ZW50KGMpO1xuICAgICAgICAgICAgICAgIGNvbnN0aXR1ZW50cy5wdXNoKHtcbiAgICAgICAgICAgICAgICAgICAgLi4ubWFwcGVkLFxuICAgICAgICAgICAgICAgICAgICByYXdEYXRhOiBjXG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAoY29uc3RpdHVlbnRzLmxlbmd0aCA+PSBDUk1fU1lOQ19DT05GSUcubWF4UmVjb3Jkc1BlclVzZXIpIGJyZWFrO1xuICAgICAgICB9XG4gICAgfSBlbHNlIGlmIChwYXJhbXMucHJvdmlkZXIgPT09IFwidmlydHVvdXNcIikge1xuICAgICAgICBmb3IgYXdhaXQgKGNvbnN0IGJhdGNoIG9mIGZldGNoQWxsVmlydHVvdXNDb250YWN0cyhwYXJhbXMuYXBpS2V5LCBDUk1fU1lOQ19DT05GSUcuYmF0Y2hTaXplKSl7XG4gICAgICAgICAgICBmb3IgKGNvbnN0IGMgb2YgYmF0Y2gpe1xuICAgICAgICAgICAgICAgIGNvbnN0IG1hcHBlZCA9IG1hcFZpcnR1b3VzQ29udGFjdChjKTtcbiAgICAgICAgICAgICAgICBjb25zdGl0dWVudHMucHVzaCh7XG4gICAgICAgICAgICAgICAgICAgIC4uLm1hcHBlZCxcbiAgICAgICAgICAgICAgICAgICAgcmF3RGF0YTogY1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKGNvbnN0aXR1ZW50cy5sZW5ndGggPj0gQ1JNX1NZTkNfQ09ORklHLm1heFJlY29yZHNQZXJVc2VyKSBicmVhaztcbiAgICAgICAgfVxuICAgIH0gZWxzZSBpZiAocGFyYW1zLnByb3ZpZGVyID09PSBcIm5lb25jcm1cIikge1xuICAgICAgICBjb25zdCBjcmVkZW50aWFscyA9IHBhcnNlTmVvbkNSTUNyZWRlbnRpYWxzKHBhcmFtcy5hcGlLZXkpO1xuICAgICAgICBpZiAoIWNyZWRlbnRpYWxzKSB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCJJbnZhbGlkIE5lb24gQ1JNIGNyZWRlbnRpYWxzIGZvcm1hdFwiKTtcbiAgICAgICAgfVxuICAgICAgICBjb25zdCBhY2NvdW50cyA9IGF3YWl0IGZldGNoQWxsTmVvbkNSTUFjY291bnRzKGNyZWRlbnRpYWxzKTtcbiAgICAgICAgZm9yIChjb25zdCBjIG9mIGFjY291bnRzKXtcbiAgICAgICAgICAgIGNvbnN0IG1hcHBlZCA9IG1hcE5lb25DUk1BY2NvdW50KGMpO1xuICAgICAgICAgICAgY29uc3RpdHVlbnRzLnB1c2goe1xuICAgICAgICAgICAgICAgIC4uLm1hcHBlZCxcbiAgICAgICAgICAgICAgICByYXdEYXRhOiBjXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIGlmIChjb25zdGl0dWVudHMubGVuZ3RoID49IENSTV9TWU5DX0NPTkZJRy5tYXhSZWNvcmRzUGVyVXNlcikgYnJlYWs7XG4gICAgICAgIH1cbiAgICB9IGVsc2UgaWYgKHBhcmFtcy5wcm92aWRlciA9PT0gXCJkb25vcnBlcmZlY3RcIikge1xuICAgICAgICBmb3IgYXdhaXQgKGNvbnN0IGJhdGNoIG9mIGZldGNoQWxsRG9ub3JQZXJmZWN0RG9ub3JzKHBhcmFtcy5hcGlLZXksIENSTV9TWU5DX0NPTkZJRy5iYXRjaFNpemUpKXtcbiAgICAgICAgICAgIGZvciAoY29uc3QgZCBvZiBiYXRjaCl7XG4gICAgICAgICAgICAgICAgY29uc3QgbWFwcGVkID0gbWFwRG9ub3JQZXJmZWN0RG9ub3IoZCk7XG4gICAgICAgICAgICAgICAgY29uc3RpdHVlbnRzLnB1c2goe1xuICAgICAgICAgICAgICAgICAgICAuLi5tYXBwZWQsXG4gICAgICAgICAgICAgICAgICAgIHJhd0RhdGE6IGRcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmIChjb25zdGl0dWVudHMubGVuZ3RoID49IENSTV9TWU5DX0NPTkZJRy5tYXhSZWNvcmRzUGVyVXNlcikgYnJlYWs7XG4gICAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuIHtcbiAgICAgICAgY29uc3RpdHVlbnRzXG4gICAgfTtcbn1cbi8qKlxuICogRmV0Y2ggYWxsIGRvbmF0aW9ucyBmcm9tIENSTSBwcm92aWRlclxuICovIGFzeW5jIGZ1bmN0aW9uIGZldGNoRG9uYXRpb25zU3RlcChwYXJhbXMpIHtcbiAgICBjb25zdCB7IGZldGNoQWxsQmxvb21lcmFuZ1RyYW5zYWN0aW9ucywgZmV0Y2hBbGxWaXJ0dW91c0dpZnRzLCBmZXRjaEFsbE5lb25DUk1Eb25hdGlvbnMsIGZldGNoQWxsRG9ub3JQZXJmZWN0R2lmdHMsIG1hcEJsb29tZXJhbmdUcmFuc2FjdGlvbiwgbWFwVmlydHVvdXNHaWZ0LCBtYXBOZW9uQ1JNRG9uYXRpb24sIG1hcERvbm9yUGVyZmVjdEdpZnQsIHBhcnNlTmVvbkNSTUNyZWRlbnRpYWxzLCBDUk1fU1lOQ19DT05GSUcgfSA9IGF3YWl0IGltcG9ydChcIkAvbGliL2NybVwiKTtcbiAgICBjb25zdCBkb25hdGlvbnMgPSBbXTtcbiAgICBpZiAocGFyYW1zLnByb3ZpZGVyID09PSBcImJsb29tZXJhbmdcIikge1xuICAgICAgICBmb3IgYXdhaXQgKGNvbnN0IGJhdGNoIG9mIGZldGNoQWxsQmxvb21lcmFuZ1RyYW5zYWN0aW9ucyhwYXJhbXMuYXBpS2V5LCBDUk1fU1lOQ19DT05GSUcuYmF0Y2hTaXplKSl7XG4gICAgICAgICAgICBmb3IgKGNvbnN0IHQgb2YgYmF0Y2gpe1xuICAgICAgICAgICAgICAgIGNvbnN0IG1hcHBlZCA9IG1hcEJsb29tZXJhbmdUcmFuc2FjdGlvbih0KTtcbiAgICAgICAgICAgICAgICBkb25hdGlvbnMucHVzaCh7XG4gICAgICAgICAgICAgICAgICAgIC4uLm1hcHBlZCxcbiAgICAgICAgICAgICAgICAgICAgcmF3RGF0YTogdFxuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfSBlbHNlIGlmIChwYXJhbXMucHJvdmlkZXIgPT09IFwidmlydHVvdXNcIikge1xuICAgICAgICBmb3IgYXdhaXQgKGNvbnN0IGJhdGNoIG9mIGZldGNoQWxsVmlydHVvdXNHaWZ0cyhwYXJhbXMuYXBpS2V5LCBDUk1fU1lOQ19DT05GSUcuYmF0Y2hTaXplKSl7XG4gICAgICAgICAgICBmb3IgKGNvbnN0IGcgb2YgYmF0Y2gpe1xuICAgICAgICAgICAgICAgIGNvbnN0IG1hcHBlZCA9IG1hcFZpcnR1b3VzR2lmdChnKTtcbiAgICAgICAgICAgICAgICBkb25hdGlvbnMucHVzaCh7XG4gICAgICAgICAgICAgICAgICAgIC4uLm1hcHBlZCxcbiAgICAgICAgICAgICAgICAgICAgcmF3RGF0YTogZ1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfSBlbHNlIGlmIChwYXJhbXMucHJvdmlkZXIgPT09IFwibmVvbmNybVwiKSB7XG4gICAgICAgIGNvbnN0IGNyZWRlbnRpYWxzID0gcGFyc2VOZW9uQ1JNQ3JlZGVudGlhbHMocGFyYW1zLmFwaUtleSk7XG4gICAgICAgIGlmICghY3JlZGVudGlhbHMpIHtcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihcIkludmFsaWQgTmVvbiBDUk0gY3JlZGVudGlhbHMgZm9ybWF0XCIpO1xuICAgICAgICB9XG4gICAgICAgIGNvbnN0IGFsbERvbmF0aW9ucyA9IGF3YWl0IGZldGNoQWxsTmVvbkNSTURvbmF0aW9ucyhjcmVkZW50aWFscyk7XG4gICAgICAgIGZvciAoY29uc3QgZCBvZiBhbGxEb25hdGlvbnMpe1xuICAgICAgICAgICAgY29uc3QgbWFwcGVkID0gbWFwTmVvbkNSTURvbmF0aW9uKGQpO1xuICAgICAgICAgICAgZG9uYXRpb25zLnB1c2goe1xuICAgICAgICAgICAgICAgIC4uLm1hcHBlZCxcbiAgICAgICAgICAgICAgICByYXdEYXRhOiBkXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgIH0gZWxzZSBpZiAocGFyYW1zLnByb3ZpZGVyID09PSBcImRvbm9ycGVyZmVjdFwiKSB7XG4gICAgICAgIGZvciBhd2FpdCAoY29uc3QgYmF0Y2ggb2YgZmV0Y2hBbGxEb25vclBlcmZlY3RHaWZ0cyhwYXJhbXMuYXBpS2V5LCBDUk1fU1lOQ19DT05GSUcuYmF0Y2hTaXplKSl7XG4gICAgICAgICAgICBmb3IgKGNvbnN0IGcgb2YgYmF0Y2gpe1xuICAgICAgICAgICAgICAgIGNvbnN0IG1hcHBlZCA9IG1hcERvbm9yUGVyZmVjdEdpZnQoZyk7XG4gICAgICAgICAgICAgICAgZG9uYXRpb25zLnB1c2goe1xuICAgICAgICAgICAgICAgICAgICAuLi5tYXBwZWQsXG4gICAgICAgICAgICAgICAgICAgIHJhd0RhdGE6IGdcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH1cbiAgICByZXR1cm4ge1xuICAgICAgICBkb25hdGlvbnNcbiAgICB9O1xufVxuLyoqXG4gKiBVcHNlcnQgY29uc3RpdHVlbnRzIHRvIGRhdGFiYXNlIGluIGJhdGNoZXNcbiAqLyBhc3luYyBmdW5jdGlvbiB1cHNlcnRDb25zdGl0dWVudHNTdGVwKGNvbnN0aXR1ZW50cywgdXNlcklkLCBzeW5jTG9nSWQpIHtcbiAgICBjb25zdCB7IGNyZWF0ZUNsaWVudCB9ID0gYXdhaXQgaW1wb3J0KFwiQC9saWIvc3VwYWJhc2Uvc2VydmVyXCIpO1xuICAgIGNvbnN0IHsgQ1JNX1NZTkNfQ09ORklHLCBDUk1fQVBJX0NPTkZJRyB9ID0gYXdhaXQgaW1wb3J0KFwiQC9saWIvY3JtXCIpO1xuICAgIGNvbnN0IHN1cGFiYXNlID0gYXdhaXQgY3JlYXRlQ2xpZW50KCk7XG4gICAgaWYgKCFzdXBhYmFzZSkge1xuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCJTdXBhYmFzZSBub3QgY29uZmlndXJlZFwiKTtcbiAgICB9XG4gICAgbGV0IHN5bmNlZCA9IDA7XG4gICAgbGV0IGZhaWxlZCA9IDA7XG4gICAgLy8gUHJvY2VzcyBpbiBiYXRjaGVzIHdpdGggcmF0ZSBsaW1pdGluZ1xuICAgIGZvcihsZXQgaSA9IDA7IGkgPCBjb25zdGl0dWVudHMubGVuZ3RoOyBpICs9IENSTV9TWU5DX0NPTkZJRy5iYXRjaFNpemUpe1xuICAgICAgICBjb25zdCBiYXRjaCA9IGNvbnN0aXR1ZW50cy5zbGljZShpLCBpICsgQ1JNX1NZTkNfQ09ORklHLmJhdGNoU2l6ZSk7XG4gICAgICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBAdHlwZXNjcmlwdC1lc2xpbnQvbm8tZXhwbGljaXQtYW55XG4gICAgICAgIGNvbnN0IHsgZXJyb3IgfSA9IGF3YWl0IHN1cGFiYXNlLmZyb20oXCJjcm1fY29uc3RpdHVlbnRzXCIpLnVwc2VydChiYXRjaC5tYXAoKGMpPT4oe1xuICAgICAgICAgICAgICAgIHVzZXJfaWQ6IHVzZXJJZCxcbiAgICAgICAgICAgICAgICBwcm92aWRlcjogYy5wcm92aWRlcixcbiAgICAgICAgICAgICAgICBleHRlcm5hbF9pZDogYy5leHRlcm5hbElkLFxuICAgICAgICAgICAgICAgIGZpcnN0X25hbWU6IGMuZmlyc3ROYW1lLFxuICAgICAgICAgICAgICAgIGxhc3RfbmFtZTogYy5sYXN0TmFtZSxcbiAgICAgICAgICAgICAgICBmdWxsX25hbWU6IGMuZnVsbE5hbWUsXG4gICAgICAgICAgICAgICAgZW1haWw6IGMuZW1haWwsXG4gICAgICAgICAgICAgICAgcGhvbmU6IGMucGhvbmUsXG4gICAgICAgICAgICAgICAgc3RyZWV0X2FkZHJlc3M6IGMuc3RyZWV0QWRkcmVzcyxcbiAgICAgICAgICAgICAgICBjaXR5OiBjLmNpdHksXG4gICAgICAgICAgICAgICAgc3RhdGU6IGMuc3RhdGUsXG4gICAgICAgICAgICAgICAgemlwX2NvZGU6IGMuemlwQ29kZSxcbiAgICAgICAgICAgICAgICBjb3VudHJ5OiBjLmNvdW50cnksXG4gICAgICAgICAgICAgICAgdG90YWxfbGlmZXRpbWVfZ2l2aW5nOiBjLnRvdGFsTGlmZXRpbWVHaXZpbmcsXG4gICAgICAgICAgICAgICAgbGFyZ2VzdF9naWZ0OiBjLmxhcmdlc3RHaWZ0LFxuICAgICAgICAgICAgICAgIGxhc3RfZ2lmdF9hbW91bnQ6IGMubGFzdEdpZnRBbW91bnQsXG4gICAgICAgICAgICAgICAgbGFzdF9naWZ0X2RhdGU6IGMubGFzdEdpZnREYXRlLFxuICAgICAgICAgICAgICAgIGZpcnN0X2dpZnRfZGF0ZTogYy5maXJzdEdpZnREYXRlLFxuICAgICAgICAgICAgICAgIGdpZnRfY291bnQ6IGMuZ2lmdENvdW50LFxuICAgICAgICAgICAgICAgIGN1c3RvbV9maWVsZHM6IGMuY3VzdG9tRmllbGRzIHx8IHt9LFxuICAgICAgICAgICAgICAgIHJhd19kYXRhOiBjLnJhd0RhdGEsXG4gICAgICAgICAgICAgICAgc3luY2VkX2F0OiBuZXcgRGF0ZSgpLnRvSVNPU3RyaW5nKClcbiAgICAgICAgICAgIH0pKSwge1xuICAgICAgICAgICAgb25Db25mbGljdDogXCJ1c2VyX2lkLHByb3ZpZGVyLGV4dGVybmFsX2lkXCJcbiAgICAgICAgfSk7XG4gICAgICAgIGlmIChlcnJvcikge1xuICAgICAgICAgICAgY29uc29sZS5lcnJvcihcIltDUk0gU3luY10gRXJyb3IgdXBzZXJ0aW5nIGNvbnN0aXR1ZW50cyBiYXRjaDpcIiwgZXJyb3IpO1xuICAgICAgICAgICAgZmFpbGVkICs9IGJhdGNoLmxlbmd0aDtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHN5bmNlZCArPSBiYXRjaC5sZW5ndGg7XG4gICAgICAgIH1cbiAgICAgICAgLy8gVXBkYXRlIHByb2dyZXNzIGluIHN5bmMgbG9nXG4gICAgICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBAdHlwZXNjcmlwdC1lc2xpbnQvbm8tZXhwbGljaXQtYW55XG4gICAgICAgIGF3YWl0IHN1cGFiYXNlLmZyb20oXCJjcm1fc3luY19sb2dzXCIpLnVwZGF0ZSh7XG4gICAgICAgICAgICByZWNvcmRzX3N5bmNlZDogc3luY2VkLFxuICAgICAgICAgICAgcmVjb3Jkc19mYWlsZWQ6IGZhaWxlZFxuICAgICAgICB9KS5lcShcImlkXCIsIHN5bmNMb2dJZCk7XG4gICAgICAgIC8vIFJhdGUgbGltaXQgZGVsYXkgYmV0d2VlbiBiYXRjaGVzXG4gICAgICAgIGF3YWl0IG5ldyBQcm9taXNlKChyZXNvbHZlKT0+c2V0VGltZW91dChyZXNvbHZlLCBDUk1fQVBJX0NPTkZJRy5yYXRlTGltaXREZWxheSkpO1xuICAgIH1cbiAgICByZXR1cm4ge1xuICAgICAgICBzeW5jZWQsXG4gICAgICAgIGZhaWxlZFxuICAgIH07XG59XG4vKipcbiAqIFVwc2VydCBkb25hdGlvbnMgdG8gZGF0YWJhc2UgaW4gYmF0Y2hlc1xuICovIGFzeW5jIGZ1bmN0aW9uIHVwc2VydERvbmF0aW9uc1N0ZXAoZG9uYXRpb25zLCB1c2VySWQsIHN5bmNMb2dJZCwgcHJldmlvdXNTeW5jZWQsIHByZXZpb3VzRmFpbGVkKSB7XG4gICAgY29uc3QgeyBjcmVhdGVDbGllbnQgfSA9IGF3YWl0IGltcG9ydChcIkAvbGliL3N1cGFiYXNlL3NlcnZlclwiKTtcbiAgICBjb25zdCB7IENSTV9TWU5DX0NPTkZJRywgQ1JNX0FQSV9DT05GSUcgfSA9IGF3YWl0IGltcG9ydChcIkAvbGliL2NybVwiKTtcbiAgICBjb25zdCBzdXBhYmFzZSA9IGF3YWl0IGNyZWF0ZUNsaWVudCgpO1xuICAgIGlmICghc3VwYWJhc2UpIHtcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwiU3VwYWJhc2Ugbm90IGNvbmZpZ3VyZWRcIik7XG4gICAgfVxuICAgIGxldCBzeW5jZWQgPSBwcmV2aW91c1N5bmNlZDtcbiAgICBsZXQgZmFpbGVkID0gcHJldmlvdXNGYWlsZWQ7XG4gICAgZm9yKGxldCBpID0gMDsgaSA8IGRvbmF0aW9ucy5sZW5ndGg7IGkgKz0gQ1JNX1NZTkNfQ09ORklHLmJhdGNoU2l6ZSl7XG4gICAgICAgIGNvbnN0IGJhdGNoID0gZG9uYXRpb25zLnNsaWNlKGksIGkgKyBDUk1fU1lOQ19DT05GSUcuYmF0Y2hTaXplKTtcbiAgICAgICAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIEB0eXBlc2NyaXB0LWVzbGludC9uby1leHBsaWNpdC1hbnlcbiAgICAgICAgY29uc3QgeyBlcnJvciB9ID0gYXdhaXQgc3VwYWJhc2UuZnJvbShcImNybV9kb25hdGlvbnNcIikudXBzZXJ0KGJhdGNoLm1hcCgoZCk9Pih7XG4gICAgICAgICAgICAgICAgdXNlcl9pZDogdXNlcklkLFxuICAgICAgICAgICAgICAgIHByb3ZpZGVyOiBkLnByb3ZpZGVyLFxuICAgICAgICAgICAgICAgIGV4dGVybmFsX2lkOiBkLmV4dGVybmFsSWQsXG4gICAgICAgICAgICAgICAgY29uc3RpdHVlbnRfZXh0ZXJuYWxfaWQ6IGQuY29uc3RpdHVlbnRFeHRlcm5hbElkLFxuICAgICAgICAgICAgICAgIGFtb3VudDogZC5hbW91bnQsXG4gICAgICAgICAgICAgICAgZG9uYXRpb25fZGF0ZTogZC5kb25hdGlvbkRhdGUsXG4gICAgICAgICAgICAgICAgZG9uYXRpb25fdHlwZTogZC5kb25hdGlvblR5cGUsXG4gICAgICAgICAgICAgICAgY2FtcGFpZ25fbmFtZTogZC5jYW1wYWlnbk5hbWUsXG4gICAgICAgICAgICAgICAgZnVuZF9uYW1lOiBkLmZ1bmROYW1lLFxuICAgICAgICAgICAgICAgIHBheW1lbnRfbWV0aG9kOiBkLnBheW1lbnRNZXRob2QsXG4gICAgICAgICAgICAgICAgc3RhdHVzOiBkLnN0YXR1cyxcbiAgICAgICAgICAgICAgICBub3RlczogZC5ub3RlcyxcbiAgICAgICAgICAgICAgICBjdXN0b21fZmllbGRzOiBkLmN1c3RvbUZpZWxkcyB8fCB7fSxcbiAgICAgICAgICAgICAgICByYXdfZGF0YTogZC5yYXdEYXRhLFxuICAgICAgICAgICAgICAgIHN5bmNlZF9hdDogbmV3IERhdGUoKS50b0lTT1N0cmluZygpXG4gICAgICAgICAgICB9KSksIHtcbiAgICAgICAgICAgIG9uQ29uZmxpY3Q6IFwidXNlcl9pZCxwcm92aWRlcixleHRlcm5hbF9pZFwiXG4gICAgICAgIH0pO1xuICAgICAgICBpZiAoZXJyb3IpIHtcbiAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoXCJbQ1JNIFN5bmNdIEVycm9yIHVwc2VydGluZyBkb25hdGlvbnMgYmF0Y2g6XCIsIGVycm9yKTtcbiAgICAgICAgICAgIGZhaWxlZCArPSBiYXRjaC5sZW5ndGg7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBzeW5jZWQgKz0gYmF0Y2gubGVuZ3RoO1xuICAgICAgICB9XG4gICAgICAgIC8vIFVwZGF0ZSBwcm9ncmVzc1xuICAgICAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgQHR5cGVzY3JpcHQtZXNsaW50L25vLWV4cGxpY2l0LWFueVxuICAgICAgICBhd2FpdCBzdXBhYmFzZS5mcm9tKFwiY3JtX3N5bmNfbG9nc1wiKS51cGRhdGUoe1xuICAgICAgICAgICAgcmVjb3Jkc19zeW5jZWQ6IHN5bmNlZCxcbiAgICAgICAgICAgIHJlY29yZHNfZmFpbGVkOiBmYWlsZWRcbiAgICAgICAgfSkuZXEoXCJpZFwiLCBzeW5jTG9nSWQpO1xuICAgICAgICBhd2FpdCBuZXcgUHJvbWlzZSgocmVzb2x2ZSk9PnNldFRpbWVvdXQocmVzb2x2ZSwgQ1JNX0FQSV9DT05GSUcucmF0ZUxpbWl0RGVsYXkpKTtcbiAgICB9XG4gICAgcmV0dXJuIHtcbiAgICAgICAgc3luY2VkLFxuICAgICAgICBmYWlsZWRcbiAgICB9O1xufVxuLyoqXG4gKiBNYXJrIHN5bmMgYXMgY29tcGxldGVkIGluIGRhdGFiYXNlXG4gKi8gYXN5bmMgZnVuY3Rpb24gbWFya1N5bmNDb21wbGV0ZVN0ZXAoc3luY0xvZ0lkLCByZWNvcmRzU3luY2VkLCByZWNvcmRzRmFpbGVkKSB7XG4gICAgY29uc3QgeyBjcmVhdGVDbGllbnQgfSA9IGF3YWl0IGltcG9ydChcIkAvbGliL3N1cGFiYXNlL3NlcnZlclwiKTtcbiAgICBjb25zdCBzdXBhYmFzZSA9IGF3YWl0IGNyZWF0ZUNsaWVudCgpO1xuICAgIGlmICghc3VwYWJhc2UpIHtcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwiU3VwYWJhc2Ugbm90IGNvbmZpZ3VyZWRcIik7XG4gICAgfVxuICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBAdHlwZXNjcmlwdC1lc2xpbnQvbm8tZXhwbGljaXQtYW55XG4gICAgYXdhaXQgc3VwYWJhc2UuZnJvbShcImNybV9zeW5jX2xvZ3NcIikudXBkYXRlKHtcbiAgICAgICAgc3RhdHVzOiBcImNvbXBsZXRlZFwiLFxuICAgICAgICByZWNvcmRzX3N5bmNlZDogcmVjb3Jkc1N5bmNlZCxcbiAgICAgICAgcmVjb3Jkc19mYWlsZWQ6IHJlY29yZHNGYWlsZWQsXG4gICAgICAgIGNvbXBsZXRlZF9hdDogbmV3IERhdGUoKS50b0lTT1N0cmluZygpXG4gICAgfSkuZXEoXCJpZFwiLCBzeW5jTG9nSWQpO1xufVxuLyoqXG4gKiBNYXJrIHN5bmMgYXMgZmFpbGVkIGluIGRhdGFiYXNlXG4gKi8gYXN5bmMgZnVuY3Rpb24gbWFya1N5bmNGYWlsZWRTdGVwKHN5bmNMb2dJZCwgcmVjb3Jkc1N5bmNlZCwgcmVjb3Jkc0ZhaWxlZCwgZXJyb3JNZXNzYWdlKSB7XG4gICAgY29uc3QgeyBjcmVhdGVDbGllbnQgfSA9IGF3YWl0IGltcG9ydChcIkAvbGliL3N1cGFiYXNlL3NlcnZlclwiKTtcbiAgICBjb25zdCBzdXBhYmFzZSA9IGF3YWl0IGNyZWF0ZUNsaWVudCgpO1xuICAgIGlmICghc3VwYWJhc2UpIHtcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwiU3VwYWJhc2Ugbm90IGNvbmZpZ3VyZWRcIik7XG4gICAgfVxuICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBAdHlwZXNjcmlwdC1lc2xpbnQvbm8tZXhwbGljaXQtYW55XG4gICAgYXdhaXQgc3VwYWJhc2UuZnJvbShcImNybV9zeW5jX2xvZ3NcIikudXBkYXRlKHtcbiAgICAgICAgc3RhdHVzOiBcImZhaWxlZFwiLFxuICAgICAgICByZWNvcmRzX3N5bmNlZDogcmVjb3Jkc1N5bmNlZCxcbiAgICAgICAgcmVjb3Jkc19mYWlsZWQ6IHJlY29yZHNGYWlsZWQsXG4gICAgICAgIGVycm9yX21lc3NhZ2U6IGVycm9yTWVzc2FnZSxcbiAgICAgICAgY29tcGxldGVkX2F0OiBuZXcgRGF0ZSgpLnRvSVNPU3RyaW5nKClcbiAgICB9KS5lcShcImlkXCIsIHN5bmNMb2dJZCk7XG59XG4vLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG4vLyBNQUlOIFdPUktGTE9XIEZVTkNUSU9OXG4vLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG4vKipcbiAqIER1cmFibGUgQ1JNIFN5bmMgV29ya2Zsb3dcbiAqXG4gKiBUaGlzIGlzIHRoZSBtYWluIHdvcmtmbG93IGZ1bmN0aW9uIHRoYXQgb3JjaGVzdHJhdGVzIHRoZSBDUk0gc3luYyBwcm9jZXNzLlxuICogRWFjaCBzdGVwIGlzIGF1dG9tYXRpY2FsbHkgY2hlY2twb2ludGVkLCBhbGxvd2luZyB0aGUgd29ya2Zsb3cgdG8gcmVzdW1lXG4gKiBmcm9tIHRoZSBsYXN0IGNvbXBsZXRlZCBzdGVwIGlmIGludGVycnVwdGVkLlxuICpcbiAqIEBwYXJhbSBwYXJhbXMgLSBWYWxpZGF0ZWQgc3luYyBwYXJhbWV0ZXJzXG4gKiBAcmV0dXJucyBDUk1TeW5jUmVzdWx0IHdpdGggY291bnRzIGFuZCBkdXJhdGlvblxuICpcbiAqIEBleGFtcGxlXG4gKiBgYGB0eXBlc2NyaXB0XG4gKiBpbXBvcnQgeyBzeW5jQ1JNRGF0YSB9IGZyb20gXCJAL2xpYi93b3JrZmxvd3MvY3JtLXN5bmMud29ya2Zsb3dcIlxuICogaW1wb3J0IHsgcnVuRHVyYWJsZVdvcmtmbG93IH0gZnJvbSBcIkAvbGliL3dvcmtmbG93c1wiXG4gKlxuICogY29uc3QgcmVzdWx0ID0gYXdhaXQgcnVuRHVyYWJsZVdvcmtmbG93KHN5bmNDUk1EYXRhLCB7XG4gKiAgIHVzZXJJZDogdXNlci5pZCxcbiAqICAgcHJvdmlkZXI6IFwiYmxvb21lcmFuZ1wiLFxuICogICBhcGlLZXk6IGRlY3J5cHRlZEtleSxcbiAqICAgc3luY0xvZ0lkOiBzeW5jTG9nLmlkLFxuICogfSlcbiAqIGBgYFxuICovIGV4cG9ydCBhc3luYyBmdW5jdGlvbiBzeW5jQ1JNRGF0YShwYXJhbXMpIHtcbiAgICB0aHJvdyBuZXcgRXJyb3IoXCJZb3UgYXR0ZW1wdGVkIHRvIGV4ZWN1dGUgd29ya2Zsb3cgc3luY0NSTURhdGEgZnVuY3Rpb24gZGlyZWN0bHkuIFRvIHN0YXJ0IGEgd29ya2Zsb3csIHVzZSBzdGFydChzeW5jQ1JNRGF0YSkgZnJvbSB3b3JrZmxvdy9hcGlcIik7XG59XG5zeW5jQ1JNRGF0YS53b3JrZmxvd0lkID0gXCJ3b3JrZmxvdy8vbGliL3dvcmtmbG93cy9jcm0tc3luYy53b3JrZmxvdy50cy8vc3luY0NSTURhdGFcIjtcbiIsICIvKipcbiAqIE1lbW9yeSBFeHRyYWN0aW9uIER1cmFibGUgV29ya2Zsb3dcbiAqXG4gKiBUaGlzIHdvcmtmbG93IGhhbmRsZXMgbWVtb3J5IGV4dHJhY3Rpb24gZnJvbSBjb252ZXJzYXRpb25zIHdpdGg6XG4gKiAtIEF1dG9tYXRpYyByZXRyeSBvbiB0cmFuc2llbnQgZmFpbHVyZXMgKGVtYmVkZGluZyBBUEksIGRhdGFiYXNlKVxuICogLSBEdXJhYmxlIGNoZWNrcG9pbnRpbmcgKHJlc3VtZSBhZnRlciBzZXJ2ZXIgcmVzdGFydClcbiAqIC0gU3RlcC1sZXZlbCBvYnNlcnZhYmlsaXR5XG4gKlxuICogVW5saWtlIGZpcmUtYW5kLWZvcmdldCwgdGhpcyBlbnN1cmVzIG1lbW9yaWVzIGFyZSBldmVudHVhbGx5IHNhdmVkLlxuICovIGltcG9ydCB7IHogfSBmcm9tIFwiem9kXCI7XG4vKipfX2ludGVybmFsX3dvcmtmbG93c3tcIndvcmtmbG93c1wiOntcImxpYi93b3JrZmxvd3MvbWVtb3J5LWV4dHJhY3Rpb24ud29ya2Zsb3cudHNcIjp7XCJleHRyYWN0TWVtb3JpZXNXb3JrZmxvd1wiOntcIndvcmtmbG93SWRcIjpcIndvcmtmbG93Ly9saWIvd29ya2Zsb3dzL21lbW9yeS1leHRyYWN0aW9uLndvcmtmbG93LnRzLy9leHRyYWN0TWVtb3JpZXNXb3JrZmxvd1wifX19fSovO1xuLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuLy8gSU5QVVQgVkFMSURBVElPTiBTQ0hFTUFcbi8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cbi8qKlxuICogU3RyaWN0IHNjaGVtYSBmb3IgbWVtb3J5IGV4dHJhY3Rpb24gcGFyYW1ldGVyc1xuICovIGV4cG9ydCBjb25zdCBNZW1vcnlFeHRyYWN0aW9uUGFyYW1zU2NoZW1hID0gei5vYmplY3Qoe1xuICAgIHVzZXJJZDogei5zdHJpbmcoKS51dWlkKFwidXNlcklkIG11c3QgYmUgYSB2YWxpZCBVVUlEXCIpLFxuICAgIGNoYXRJZDogei5zdHJpbmcoKS51dWlkKFwiY2hhdElkIG11c3QgYmUgYSB2YWxpZCBVVUlEXCIpLFxuICAgIHVzZXJNZXNzYWdlOiB6LnN0cmluZygpLm1pbigxLCBcInVzZXJNZXNzYWdlIGlzIHJlcXVpcmVkXCIpLFxuICAgIGFzc2lzdGFudFJlc3BvbnNlOiB6LnN0cmluZygpLm1pbigxLCBcImFzc2lzdGFudFJlc3BvbnNlIGlzIHJlcXVpcmVkXCIpLFxuICAgIG1lc3NhZ2VJZDogei5zdHJpbmcoKS5vcHRpb25hbCgpLFxuICAgIGFwaUtleTogei5zdHJpbmcoKS5vcHRpb25hbCgpXG59KTtcbi8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cbi8vIFNURVAgRlVOQ1RJT05TXG4vLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG4vKipcbiAqIENoZWNrIGlmIGFuIGV4cGxpY2l0IG1lbW9yeSByZXF1ZXN0IGV4aXN0cyBpbiB0aGUgdXNlciBtZXNzYWdlXG4gKi8gYXN5bmMgZnVuY3Rpb24gZGV0ZWN0RXhwbGljaXRNZW1vcnlTdGVwKHVzZXJNZXNzYWdlKSB7XG4gICAgY29uc3QgeyBkZXRlY3RFeHBsaWNpdE1lbW9yeSB9ID0gYXdhaXQgaW1wb3J0KFwiQC9saWIvbWVtb3J5L2V4dHJhY3RvclwiKTtcbiAgICBjb25zdCBjb250ZW50ID0gZGV0ZWN0RXhwbGljaXRNZW1vcnkodXNlck1lc3NhZ2UpO1xuICAgIHJldHVybiB7XG4gICAgICAgIGhhc0V4cGxpY2l0OiAhIWNvbnRlbnQsXG4gICAgICAgIGNvbnRlbnRcbiAgICB9O1xufVxuLyoqXG4gKiBFeHRyYWN0IG1lbW9yaWVzIGZyb20gY29udmVyc2F0aW9uIHVzaW5nIEFJXG4gKi8gYXN5bmMgZnVuY3Rpb24gZXh0cmFjdE1lbW9yaWVzU3RlcCh1c2VySWQsIGNoYXRJZCwgdXNlck1lc3NhZ2UsIGFzc2lzdGFudFJlc3BvbnNlLCBhcGlLZXkpIHtcbiAgICBjb25zdCB7IGV4dHJhY3RNZW1vcmllcyB9ID0gYXdhaXQgaW1wb3J0KFwiQC9saWIvbWVtb3J5L2V4dHJhY3RvclwiKTtcbiAgICBjb25zdCBtZW1vcmllcyA9IGF3YWl0IGV4dHJhY3RNZW1vcmllcyh7XG4gICAgICAgIG1lc3NhZ2VzOiBbXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgcm9sZTogXCJ1c2VyXCIsXG4gICAgICAgICAgICAgICAgY29udGVudDogdXNlck1lc3NhZ2VcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgcm9sZTogXCJhc3Npc3RhbnRcIixcbiAgICAgICAgICAgICAgICBjb250ZW50OiBhc3Npc3RhbnRSZXNwb25zZVxuICAgICAgICAgICAgfVxuICAgICAgICBdLFxuICAgICAgICB1c2VySWQsXG4gICAgICAgIGNoYXRJZFxuICAgIH0sIGFwaUtleSk7XG4gICAgcmV0dXJuIHtcbiAgICAgICAgbWVtb3JpZXNcbiAgICB9O1xufVxuLyoqXG4gKiBDaGVjayBpZiBhIG1lbW9yeSBhbHJlYWR5IGV4aXN0cyAoZGVkdXBsaWNhdGlvbilcbiAqLyBhc3luYyBmdW5jdGlvbiBjaGVja0R1cGxpY2F0ZVN0ZXAoY29udGVudCwgdXNlcklkLCBhcGlLZXkpIHtcbiAgICBjb25zdCB7IG1lbW9yeUV4aXN0cyB9ID0gYXdhaXQgaW1wb3J0KFwiQC9saWIvbWVtb3J5L3N0b3JhZ2VcIik7XG4gICAgY29uc3QgZXhpc3RzID0gYXdhaXQgbWVtb3J5RXhpc3RzKGNvbnRlbnQsIHVzZXJJZCwgYXBpS2V5KTtcbiAgICByZXR1cm4ge1xuICAgICAgICBleGlzdHNcbiAgICB9O1xufVxuLyoqXG4gKiBHZW5lcmF0ZSBlbWJlZGRpbmcgZm9yIG1lbW9yeSBjb250ZW50XG4gKi8gYXN5bmMgZnVuY3Rpb24gZ2VuZXJhdGVFbWJlZGRpbmdTdGVwKGNvbnRlbnQsIGFwaUtleSkge1xuICAgIGNvbnN0IHsgZ2VuZXJhdGVFbWJlZGRpbmcgfSA9IGF3YWl0IGltcG9ydChcIkAvbGliL3JhZy9lbWJlZGRpbmdzXCIpO1xuICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IGdlbmVyYXRlRW1iZWRkaW5nKGNvbnRlbnQsIGFwaUtleSk7XG4gICAgcmV0dXJuIHtcbiAgICAgICAgZW1iZWRkaW5nOiByZXN1bHQuZW1iZWRkaW5nXG4gICAgfTtcbn1cbi8qKlxuICogU2F2ZSBhIG1lbW9yeSB0byB0aGUgZGF0YWJhc2VcbiAqLyBhc3luYyBmdW5jdGlvbiBzYXZlTWVtb3J5U3RlcChwYXJhbXMpIHtcbiAgICBjb25zdCB7IGNyZWF0ZU1lbW9yeSB9ID0gYXdhaXQgaW1wb3J0KFwiQC9saWIvbWVtb3J5L3N0b3JhZ2VcIik7XG4gICAgY29uc3Qgc2F2ZWRNZW1vcnkgPSBhd2FpdCBjcmVhdGVNZW1vcnkoe1xuICAgICAgICB1c2VyX2lkOiBwYXJhbXMudXNlcklkLFxuICAgICAgICBjb250ZW50OiBwYXJhbXMuY29udGVudCxcbiAgICAgICAgbWVtb3J5X3R5cGU6IHBhcmFtcy5tZW1vcnlUeXBlLFxuICAgICAgICBpbXBvcnRhbmNlX3Njb3JlOiBwYXJhbXMuaW1wb3J0YW5jZVNjb3JlLFxuICAgICAgICBtZXRhZGF0YTogcGFyYW1zLm1ldGFkYXRhLFxuICAgICAgICBlbWJlZGRpbmc6IHBhcmFtcy5lbWJlZGRpbmdcbiAgICB9KTtcbiAgICByZXR1cm4ge1xuICAgICAgICBzYXZlZDogISFzYXZlZE1lbW9yeVxuICAgIH07XG59XG4vLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG4vLyBNQUlOIFdPUktGTE9XIEZVTkNUSU9OXG4vLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG4vKipcbiAqIER1cmFibGUgTWVtb3J5IEV4dHJhY3Rpb24gV29ya2Zsb3dcbiAqXG4gKiBFeHRyYWN0cyBpbXBvcnRhbnQgZmFjdHMgZnJvbSBjb252ZXJzYXRpb25zIGFuZCBzYXZlcyB0aGVtIGFzIG1lbW9yaWVzLlxuICogRWFjaCBzdGVwIGlzIGNoZWNrcG9pbnRlZCwgZW5zdXJpbmcgbWVtb3JpZXMgYXJlIGV2ZW50dWFsbHkgc2F2ZWQgZXZlblxuICogaWYgdGhlIHNlcnZlciByZXN0YXJ0cyBtaWQtcHJvY2Vzc2luZy5cbiAqXG4gKiBAcGFyYW0gcGFyYW1zIC0gVmFsaWRhdGVkIGV4dHJhY3Rpb24gcGFyYW1ldGVyc1xuICogQHJldHVybnMgTWVtb3J5RXh0cmFjdGlvblJlc3VsdCB3aXRoIGNvdW50cyBhbmQgc3RhdHVzXG4gKlxuICogQGV4YW1wbGVcbiAqIGBgYHR5cGVzY3JpcHRcbiAqIGltcG9ydCB7IGV4dHJhY3RNZW1vcmllc1dvcmtmbG93IH0gZnJvbSBcIkAvbGliL3dvcmtmbG93cy9tZW1vcnktZXh0cmFjdGlvbi53b3JrZmxvd1wiXG4gKiBpbXBvcnQgeyBydW5EdXJhYmxlV29ya2Zsb3cgfSBmcm9tIFwiQC9saWIvd29ya2Zsb3dzXCJcbiAqXG4gKiBjb25zdCByZXN1bHQgPSBhd2FpdCBydW5EdXJhYmxlV29ya2Zsb3coZXh0cmFjdE1lbW9yaWVzV29ya2Zsb3csIHtcbiAqICAgdXNlcklkOiB1c2VyLmlkLFxuICogICBjaGF0SWQ6IGNoYXQuaWQsXG4gKiAgIHVzZXJNZXNzYWdlOiBcIlJlbWVtYmVyIHRoYXQgbXkgZG9nJ3MgbmFtZSBpcyBNYXhcIixcbiAqICAgYXNzaXN0YW50UmVzcG9uc2U6IFwiSSdsbCByZW1lbWJlciB0aGF0Li4uXCIsXG4gKiB9KVxuICogYGBgXG4gKi8gZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGV4dHJhY3RNZW1vcmllc1dvcmtmbG93KHBhcmFtcykge1xuICAgIHRocm93IG5ldyBFcnJvcihcIllvdSBhdHRlbXB0ZWQgdG8gZXhlY3V0ZSB3b3JrZmxvdyBleHRyYWN0TWVtb3JpZXNXb3JrZmxvdyBmdW5jdGlvbiBkaXJlY3RseS4gVG8gc3RhcnQgYSB3b3JrZmxvdywgdXNlIHN0YXJ0KGV4dHJhY3RNZW1vcmllc1dvcmtmbG93KSBmcm9tIHdvcmtmbG93L2FwaVwiKTtcbn1cbmV4dHJhY3RNZW1vcmllc1dvcmtmbG93LndvcmtmbG93SWQgPSBcIndvcmtmbG93Ly9saWIvd29ya2Zsb3dzL21lbW9yeS1leHRyYWN0aW9uLndvcmtmbG93LnRzLy9leHRyYWN0TWVtb3JpZXNXb3JrZmxvd1wiO1xuIiwgIlxuICAgIC8vIEJ1aWx0IGluIHN0ZXBzXG4gICAgaW1wb3J0ICd3b3JrZmxvdy9pbnRlcm5hbC9idWlsdGlucyc7XG4gICAgLy8gVXNlciBzdGVwc1xuICAgIGltcG9ydCAnLi9saWIvd29ya2Zsb3dzL2NybS1zeW5jLndvcmtmbG93LnRzJztcbmltcG9ydCAnLi9saWIvd29ya2Zsb3dzL21lbW9yeS1leHRyYWN0aW9uLndvcmtmbG93LnRzJztcbiAgICAvLyBBUEkgZW50cnlwb2ludFxuICAgIGV4cG9ydCB7IHN0ZXBFbnRyeXBvaW50IGFzIFBPU1QgfSBmcm9tICd3b3JrZmxvdy9ydW50aW1lJzsiXSwKICAibWFwcGluZ3MiOiAiOzs7Ozs7O0FBQUEsU0FBQSw0QkFBQTtBQU9FLGVBQVcsZ0NBQUEsS0FBQTtBQUNYLFNBQU8sSUFBSSxZQUFXO0FBQ3hCO0FBRmE7QUFJYixlQUFzQix3QkFBd0IsS0FBYTtBQUN6RCxTQUFBLElBQVcsS0FBQTs7QUFEUztBQUd0QixlQUFDLHdCQUFBLEtBQUE7QUFFRCxTQUFPLElBQUssS0FBQTs7QUFGWDtxQkFJa0IsbUNBQUMsK0JBQUE7QUFDcEIscUJBQUMsMkJBQUEsdUJBQUE7Ozs7QUNURyxTQUFTLFNBQVM7QUFRWCxJQUFNLHNCQUFzQixFQUFFLE9BQU87QUFBQSxFQUM1QyxRQUFRLEVBQUUsT0FBTyxFQUFFLEtBQUssNkJBQTZCO0FBQUEsRUFDckQsVUFBVSxFQUFFLEtBQUs7QUFBQSxJQUNiO0FBQUEsSUFDQTtBQUFBLElBQ0E7QUFBQSxJQUNBO0FBQUEsRUFDSixDQUFDO0FBQUEsRUFDRCxRQUFRLEVBQUUsT0FBTyxFQUFFLElBQUksR0FBRyxvQkFBb0I7QUFBQSxFQUM5QyxXQUFXLEVBQUUsT0FBTyxFQUFFLEtBQUssZ0NBQWdDO0FBQy9ELENBQUM7QUErUkcsZUFBc0IsWUFBWSxRQUFRO0FBQzFDLFFBQU0sSUFBSSxNQUFNLGdJQUFnSTtBQUNwSjtBQUYwQjtBQUcxQixZQUFZLGFBQWE7OztBQ3JUckIsU0FBUyxLQUFBQSxVQUFTO0FBT1gsSUFBTSwrQkFBK0JDLEdBQUUsT0FBTztBQUFBLEVBQ3JELFFBQVFBLEdBQUUsT0FBTyxFQUFFLEtBQUssNkJBQTZCO0FBQUEsRUFDckQsUUFBUUEsR0FBRSxPQUFPLEVBQUUsS0FBSyw2QkFBNkI7QUFBQSxFQUNyRCxhQUFhQSxHQUFFLE9BQU8sRUFBRSxJQUFJLEdBQUcseUJBQXlCO0FBQUEsRUFDeEQsbUJBQW1CQSxHQUFFLE9BQU8sRUFBRSxJQUFJLEdBQUcsK0JBQStCO0FBQUEsRUFDcEUsV0FBV0EsR0FBRSxPQUFPLEVBQUUsU0FBUztBQUFBLEVBQy9CLFFBQVFBLEdBQUUsT0FBTyxFQUFFLFNBQVM7QUFDaEMsQ0FBQztBQStGRyxlQUFzQix3QkFBd0IsUUFBUTtBQUN0RCxRQUFNLElBQUksTUFBTSx3SkFBd0o7QUFDNUs7QUFGMEI7QUFHMUIsd0JBQXdCLGFBQWE7OztBQ2xIakMsU0FBMkIsc0JBQVk7IiwKICAibmFtZXMiOiBbInoiLCAieiJdCn0K
